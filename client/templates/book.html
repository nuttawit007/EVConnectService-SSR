{% extends 'base.html' %}

{% block content %}
<!-- Main Content -->
<main class="px-8 py-12 max-w-7xl mx-auto">
    <!-- Page Title -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold mb-3">Book an Appointment</h1>
        <p class="text-slate-400">Appointment your EV service in minutes</p>
    </div>

    <!-- Choose Vehicle & Add Vehicle -->
    <div class="grid md:grid-cols-2 gap-8 mb-12">
        <!-- Choose Vehicle -->
        <div>
            <h2 class="text-2xl font-semibold mb-2">Choose Vehicle</h2>
            <p class="text-slate-400 mb-4">Choose your EV car</p>
            <select class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-slate-400 focus:outline-none focus:border-yellow-400 transition-colors">
                <option>choose your EV car</option>
                <option>Tesla Model 3</option>
                <option>Tesla Model Y</option>
                <option>Nissan Leaf</option>
                <option>Chevrolet Bolt</option>
            </select>
        </div>

        <!-- Add Vehicle -->
        <div>
            <h2 class="text-2xl font-semibold mb-2">Add Vehicle (optional)</h2>
            <p class="text-slate-400 mb-4">if you don't have EV car</p>
            <a href="{% url 'add_vehicle' %}">
                <button class="px-6 py-3 border-2 border-slate-400 text-white rounded-xl font-medium hover:bg-slate-800 transition-colors">
                    Add new vehicle
                </button>
            </a>
        </div>
    </div>

    <!-- Choose Service -->
    <div class="mb-12">
        <h2 class="text-2xl font-semibold mb-2">Choose Service</h2>
        <p class="text-slate-400 mb-6">Choose the service you need</p>

        <div class="grid md:grid-cols-4 gap-4">
            <!-- Maintenance -->
            <label class="relative cursor-pointer">
                <input type="radio" name="service" value="repair" class="peer sr-only">
                <div class="p-6 bg-slate-800 border-2 border-slate-700 rounded-xl peer-checked:border-yellow-400 transition-colors">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center">
                            <div class="w-2 h-2 bg-slate-900 rounded-full"></div>
                        </div>
                        <h3 class="font-semibold">Mainternance</h3>
                    </div>
                    <p class="text-sm text-yellow-400">บริการเช็กระยะ ดูแลรถตามกำหนด</p>
                </div>
            </label>


            <!-- Repair -->
            <label class="relative cursor-pointer">
                <input type="radio" name="service" value="repair" class="peer sr-only">
                <div class="p-6 bg-slate-800 border-2 border-slate-700 rounded-xl peer-checked:border-yellow-400 transition-colors">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center">
                            <div class="w-2 h-2 bg-slate-900 rounded-full"></div>
                        </div>
                        <h3 class="font-semibold">Repair</h3>
                    </div>
                    <p class="text-sm text-yellow-400">ซ่อมแซม ปัญหารถทุกประเภท</p>
                </div>
            </label>

            <!-- Insurance -->
            <label class="relative cursor-pointer">
                <input type="radio" name="service" value="insurance" class="peer sr-only">
                <div class="p-6 bg-slate-800 border-2 border-slate-700 rounded-xl peer-checked:border-yellow-400 transition-colors">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center">
                            <div class="w-2 h-2 bg-slate-900 rounded-full"></div>
                        </div>
                        <h3 class="font-semibold">Insurance</h3>
                    </div>
                    <p class="text-sm text-yellow-400">เคลมประกันและซ่อมตามประกันภัย</p>
                </div>
            </label>

            <!-- Other Services -->
            <label class="relative cursor-pointer">
                <input type="radio" name="service" value="other" class="peer sr-only">
                <div class="p-6 bg-slate-800 border-2 border-slate-700 rounded-xl peer-checked:border-yellow-400 transition-colors">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center">
                            <div class="w-2 h-2 bg-slate-900 rounded-full"></div>
                        </div>
                        <h3 class="font-semibold">Other Services</h3>
                    </div>
                    <p class="text-sm text-yellow-400">บริการเสริม เช่น ล้างรถ ดัดแปลงอื่น ๆ</p>
                </div>
            </label>
        </div>
    </div>

    <!-- Description -->
    <div class="mb-12">
        <h2 class="text-2xl font-semibold mb-2">Description</h2>
        <p class="text-slate-400 mb-4">Add notes or special requests for your appointment.</p>
        <textarea placeholder="เขียนรายละเอียดเพิ่มเติม"
            class="w-full h-32 px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-slate-300 placeholder-slate-500 focus:outline-none focus:border-yellow-400 transition-colors resize-none">
        </textarea>
    </div>

    <!-- Date and Time -->
    <div class="mb-12">
        <h2 class="text-2xl font-semibold mb-2">Date and Time</h2>
        <p class="text-slate-400 mb-6">Select date and time you need.</p>

        <div class="grid md:grid-cols-2 gap-6">
            <!-- Calendar -->
            <div class="bg-slate-800 rounded-xl p-6">
                <div class="flex items-center justify-between mb-4">
                    <button id="prevMonth" class="p-2 hover:bg-slate-700 rounded-lg transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    </button>
                    <h3 id="monthYear" class="text-center font-semibold"></h3>
                    <button id="nextMonth" class="p-2 hover:bg-slate-700 rounded-lg transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                    </button>
                </div>
                
                <!-- Days of Week -->
                <div class="grid grid-cols-7 gap-2 mb-2">
                    <div class="text-center text-sm text-slate-400 py-2">Sun</div>
                    <div class="text-center text-sm text-slate-400 py-2">Mon</div>
                    <div class="text-center text-sm text-slate-400 py-2">Tue</div>
                    <div class="text-center text-sm text-slate-400 py-2">Wed</div>
                    <div class="text-center text-sm text-slate-400 py-2">Thu</div>
                    <div class="text-center text-sm text-slate-400 py-2">Fri</div>
                    <div class="text-center text-sm text-slate-400 py-2">Sat</div>
                </div>

                <!-- Calendar Days -->
                <div id="calendarDays" class="grid grid-cols-7 gap-2">
                    <!-- Days will be generated by JavaScript -->
                </div>
            </div>

            <!-- Time Slots -->
            <div class="bg-slate-800 rounded-xl p-6">
                <h3 id="selectedDate" class="text-center font-semibold mb-6">Select a date</h3>
                
                <div class="grid grid-cols-2 gap-6">
                    <!-- Morning -->
                    <div>
                        <h4 class="font-semibold mb-4">Morning</h4>
                        <div class="flex flex-col gap-4">
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="8:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>8:00</span>
                                </div>
                            </label>
                            
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="9:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>9:00</span>
                                </div>
                            </label>
                    
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="10:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>10:00</span>
                                </div>
                            </label>
                    
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="11:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>11:00</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Afternoon -->
                    <div>
                        <h4 class="font-semibold mb-4">Afternoon</h4>
                        <div class="flex flex-col gap-4">
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="14:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>14:00</span>
                                </div>
                            </label>
                            
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="15:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>15:00</span>
                                </div>
                            </label>
                            
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="16:00" class="peer sr-only" checked>
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>16:00</span>
                                </div>
                            </label>
                            
                            <label class="relative cursor-pointer">
                                <input type="radio" name="time" value="17:00" class="peer sr-only">
                                <div class="px-4 py-2.5 bg-slate-800 border-2 border-slate-700 rounded-lg peer-checked:border-yellow-400 transition-colors flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-slate-500 peer-checked:border-yellow-400 peer-checked:bg-yellow-400 flex items-center justify-center transition-colors">
                                        <div class="w-2.5 h-2.5 bg-slate-900 rounded-full"></div>
                                    </div>
                                    <span>17:00</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Button -->
    <div class="flex justify-end">
        <a href="{% url 'appointment' %}">
            <button class="px-8 py-3 bg-yellow-400 text-slate-900 rounded-lg font-semibold hover:bg-yellow-500 transition-colors">
                confirm booking
            </button>
        </a>
    </div>
</main>

<!-- Added JavaScript for dynamic calendar functionality -->
<script>
    let currentDate = new Date();
    let selectedDate = new Date();
    
    const monthNames = ["January", "February", "March", "April", "May", "June", 
        "July", "August", "September", "October", "November", "December"];
    
    function renderCalendar() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();

        // Update month/year display
        document.getElementById('monthYear').textContent = `${monthNames[month]} ${year}`;

        // Get first day of month and number of days
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        // Get today's date for comparison
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        const calendarDays = document.getElementById('calendarDays');
        calendarDays.innerHTML = '';

        // Add empty cells for days before month starts
        for (let i = 0; i < firstDay; i++) {
            const emptyDay = document.createElement('button');
            emptyDay.className = 'py-2 text-center';
            calendarDays.appendChild(emptyDay);
        }

    // Add days of the month
        for (let day = 1; day <= daysInMonth; day++) {
            const dayButton = document.createElement('button');
            const dateToCheck = new Date(year, month, day);
            dateToCheck.setHours(0, 0, 0, 0);
            
            const isSelected = selectedDate.getDate() === day && 
                                selectedDate.getMonth() === month && 
                                selectedDate.getFullYear() === year;
            
            const isPast = dateToCheck < today;
            
            if (isPast) {
                dayButton.className = 'py-2 text-center text-slate-600 cursor-not-allowed rounded-lg';
                dayButton.disabled = true;
            } else if (isSelected) {
                dayButton.className = 'py-2 text-center bg-yellow-400 text-slate-900 font-semibold rounded-lg';
            } else {
                dayButton.className = 'py-2 text-center hover:bg-slate-700 rounded-lg transition-colors';
            }
            
            dayButton.textContent = day;
            
            if (!isPast) {
                dayButton.addEventListener('click', () => {
                selectedDate = new Date(year, month, day);
                renderCalendar();
                updateSelectedDateDisplay();
                });
            }
            
            calendarDays.appendChild(dayButton);
        }
    }
    
    function updateSelectedDateDisplay() {
        const day = selectedDate.getDate();
        const month = monthNames[selectedDate.getMonth()];
        const year = selectedDate.getFullYear();
        document.getElementById('selectedDate').textContent = `${day} ${month} ${year}`;
    }
    
    // Navigation buttons
    document.getElementById('prevMonth').addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar();
    });
    
    document.getElementById('nextMonth').addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar();
    });
    
    // Initialize calendar with today's date selected
    selectedDate = new Date();
    renderCalendar();
    updateSelectedDateDisplay();
</script>
{% endblock %}